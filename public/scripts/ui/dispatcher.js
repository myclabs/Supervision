YAHOO.namespace("plugin");
(function(){var C=YAHOO.util.Connect,g=YAHOO.lang,o=YAHOO.util.Event,p=YAHOO.util.Dom,v=YAHOO.util.Dom.get,j={LOADING:1,DISPATCHED:2,ERROR:3,EMPTY:4,proxy:"/dispatcher.php?uri=",CSSNODE:1,JSNODE:2},D=/<script([^>]*)>([\s\S]*?)<\/script>/igm,E=/src=(['"]?)([^"']*)\1/i,F=/rel=(['"]?)([^"']*)\1/i,G=/<link([^>]*)(>[\s]*<\/link>|>)/igm,H=/href=(['"]?)([^"']*)\1/i,I=/<style([^>]*)>([\s\S]*?)<\/style>/igm,y=/([\w-.]+)\s*=\s*(".*?"|'.*?'|\w+)*/im,J=new RegExp("url\\s*\\(([^\\)]*)","igm"),z=/^((?:http|https):\/\/)((?:\w+[.|-]?)*\w+)(\/.*)$/i;
YAHOO.plugin.Dispatcher=function(){function K(a,c){var b=L;a=b.parser[c?"strict":"loose"].exec(a);var d={};for(c=14;c--;)d[b.key[c]]=a[c]||"";d[b.q.name]={};d[b.key[12]].replace(b.q.parser,function(f,h,k){if(h)d[b.q.name][h]=k});return d}function M(a){var c=document.getElementsByTagName("head")[0]||document.documentElement,b=document.createElement("script");if(a=a.replace(N,"")){b.type="text/javascript";if(YAHOO.env.ua.ie)b.text=a;else b.appendChild(document.createTextNode(a));c.insertBefore(b,c.firstChild);
c.removeChild(b)}}function A(a){if(g.isString(a)){a=a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1");a=a.replace(/^(['|"])*(\S*(?:\s+\S+)*)\1$/,"$2")}return a}function r(a,c){var b=null,d={};c=c||{};if(g.isString(a))for(;b=y.exec(a);){b[2]=c.hasOwnProperty(b[1])?c[b[1]]:b[2];if(b[2])d[b[1]]=A(b[2]);a=a.replace(y,"")}return d}function w(a){a=(g.isString(a)&&a.indexOf("/")>-1?a:q.baseURI)+"";return a.substr(0,a.lastIndexOf("/")+1)}function s(a,c){if(c&&!z.test(c)&&c.indexOf("/")!==0)c=a+c;return c}function t(a){if(a.element&&
a.element.setAttribute){a.element.setAttribute("aria-live","polite");a.element.setAttribute("aria-atomic","true");a.element.setAttribute("aria-relevant","all");a.element.setAttribute("aria-busy","true")}a.onStart=a.before||a.onStart;if(g.isFunction(a.onStart)){a.onStart.apply(a,[a.element]);a.onStart=null}!a.underground&&YAHOO.Bubbling&&YAHOO.Bubbling.fire("onAsyncRequestStart",{element:a.element})}function x(a,c){if(g.isFunction(a.onChange)){c=c||a.element;a.onChange.apply(a,[c])}}function O(a){a.onLoad=
a.after||a.onLoad;g.isFunction(a.onLoad)&&a.onLoad.apply(a,[a.element]);!a.underground&&YAHOO.Bubbling&&YAHOO.Bubbling.fire("onAsyncRequestEnd",{element:a.element});a.element&&a.element.setAttribute&&a.element.setAttribute("aria-busy","false")}function m(a,c){var b=true,d=null,f="",h=0;c=c||{};if(e.isAlive(a)){d=i[a].chunks.shift();if(g.isObject(d)&&d.src){c.hash=l.length;for(h=0;h<l.length;h++)if(l[h].uri==d.src){if(l[h].status==j.DISPATCHED&&!c.override)b=false;c.hash=h;break}if(b){f=e.firewall(d.src,
c,true);if(g.isString(f)&&f!==""){l[c.hash]={uri:d.src,proxy:f,status:j.LOADING};if(d.type===j.JSNODE){e.area=a;e.destroyer=i[a].destroyer;c.handle=YAHOO.util.Get.script(f,{onSuccess:function(){l[c.hash].status=j.DISPATCHED;c.rel&&YAHOO.Bubbling&&YAHOO.Bubbling.fire("onScriptReady",{module:d.rel,src:d.src,uri:f,hash:c.hash});c.hash=null;m(a,c)},onFailure:function(){m(a,c)},scope:e,data:c})}else if(d.type===j.CSSNODE){YAHOO.util.Get.css(f,{});l[c.hash].status=j.DISPATCHED;m(a,c)}}}else m(a,c)}else{c.hash=
null;P(a,d.content,c)}}else{e.kill(a);O(c)}}function P(a,c,b){var d=j.EMPTY;if(c&&c!=="")try{d=j.DISPATCHED;if(!b.hash||l[b.hash].status!=j.DISPATCHED){e.area=a;e.destroyer=i[a].destroyer;g.isFunction(b.evalRoutine)?b.evalRoutine(c,b):M(c)}}catch(f){d=j.ERROR;if(g.isFunction(b.error))b.error.apply(b,[a,c,l,f]);else throw new Error("Dispacher: Script Execution Error ("+f+")");}if(g.isNumber(b.hash)){l[b.hash].status=d;b.hash=null}m(a,b)}function Q(a,c,b){b.action=b.action?b.action:"replace";switch(b.action){case "tabview":B(a.get("contentEl"),
b);try{a.set("content",c)}catch(d){return false}x(b,a.get("contentEl"));break;case "update":c=a.innerHTML+c;try{a.innerHTML=c}catch(f){return false}x(b,a);break;case "replace":case "layout":default:B(a,b);try{a.innerHTML=c}catch(h){return false}x(b,a);break}return true}function B(a,c){var b=c.guid,d=0;g.isObject(i[b].destroyer)&&i[b].destroyer.fire(a,c);if(p.inDocument(a)){for(d=0;d<a.childNodes.length;d++)o.purgeElement(a.childNodes[d],true);p.addClass(a,R)}i[b].destroyer=new YAHOO.util.CustomEvent("destroyer");
g.isFunction(c.onDestroy)&&i[b].destroyer.subscribe(c.onDestroy)}function S(a,c,b){b=b||{};b.uri=b.uri||null;b.relative=b.relative||q.relative;var d=false,f=w(b.uri);c=c.replace(I,function(h,k,n){n&&e.applyCSS(n,r(k),b);return""});c=c.replace(G,function(h,k){if(k)if(d=k.match(H)){if(b.relative)d[2]=s(f,d[2]);i[a].chunks.push({src:d[2],content:"",type:j.CSSNODE,params:r(k)})}return""});return c=c.replace(D,function(h,k,n){if(k)if(d=k.match(E)){h=(h=k.match(F))?h[2]:null;if(b.relative)d[2]=s(f,d[2]);
i[a].chunks.push({src:d[2],content:"",type:j.JSNODE,rel:h,params:r(k)})}n&&i[a].chunks.push({src:null,content:n,type:j.JSNODE,params:r(k)});return""})}var e={},i={},l=[],q={relative:false,baseURI:document.location.toString()},R="yui-dispatchable",L={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},N=/^\s+|\s+$/g;YAHOO.Bubbling&&YAHOO.Bubbling.on("onScriptReady",function(){if(this.src&&!this.hash)l[this.hash].status=j.DISPATCHED});e.area=null;e.strictMode=true;e.destroyer=null;e.fetch=function(a,c,b){b=b||{};b.uri=c;var d=null;d=null;var f={success:function(h){h.responseText!="undefined"&&e.process(a,
h.responseText,b,true);p.removeClass(a,"loading")},failure:function(h){g.isFunction(b.onError)&&b.onError.apply(b,[b.element,h]);p.removeClass(a,"loading")}};if((g.isObject(a)||(a=v(a)))&&c){d=e.firewall(c,b);p.addClass(a,"loading");b.handle=C.asyncRequest("GET",d,f);b.element=a;t(b);if(YAHOO.Bubbling){d=b.guid||o.generateId(a);YAHOO.Bubbling.fire("onNavigate",{state:d+escape(c),control:"dispatcher",element:a,uri:c,config:b,restore:function(){e.fetch(a,c,b)}})}return b.handle}return null};e.process=
function(a,c,b,d){var f=null;b=b||{};if(g.isObject(a)||(a=v(a))){f=b.guid||o.generateId(a);this.kill(f);b.element=a;b.content=c;b.guid=f;d||t(b);Q(a,S(f,c,b),b)&&m(f,b)}return f};e.delegate=function(a,c,b){b=b||{};b.action="tabview";b.uri=a.get("dataSrc")||null;b.tab=a;a.loadHandler.success=function(d){var f=a.get("contentEl");b.tab=f;b.underground=true;e.process(a,d.responseText,b);YAHOO.Bubbling&&YAHOO.Bubbling.fire("onAsyncRequestEnd",{element:f})};a.on("activeChange",function(){YAHOO.Bubbling&&
this.get("active")&&a.get("dataSrc")&&!this.get("cacheData")&&YAHOO.Bubbling.fire("onAsyncRequestStart",{element:this.get("contentEl")})});g.isObject(c)&&c.addTab(a)};e.addUnit=function(a,c,b){b=b||{};var d;b.action="layout";if(!a||!c)return false;if(g.isString(a))a=c.getUnitByPosition(a);else if(a.position&&!c.getUnitByPosition(a.position))a=c.addUnit(a);b.uri&&a.set("dataSrc",b.uri);if((b.unit=a)&&(b.uri=b.unit.get("dataSrc"))&&(d=b.unit.body)){b.underground=true;b._dispatcherConfig=b;b.unit.loadHandler.success=
function(f){e.process(this.body,f.responseText,this._dispatcherConfig);YAHOO.Bubbling&&YAHOO.Bubbling.fire("onAsyncRequestEnd",{element:this.body})};b.unit.loadContent()&&YAHOO.Bubbling&&YAHOO.Bubbling.fire("onAsyncRequestStart",{element:d})}return b.unit};e.applyCSS=function(a,c,b){c=c||{};var d=document.createElement("style"),f=c.href||"";b=b||{};var h=b.uri||q.baseURI;b.relative=b.relative||q.relative;if(b.relative){h=e.firewall(h,b,true);f=w(h);f=s(f,c.href)}f=w(f);a=a.replace(J,function(n,u){u=
A(u);return u="url("+s(f,u)});d.type="text/css";if(g.isObject(d.styleSheet))d.styleSheet.cssText=a;else d.appendChild(document.createTextNode(a));try{document.getElementsByTagName("head")[0].appendChild(d)}catch(k){throw new Error("Dispacher: CSS Processing Error ("+k+")");}return true};e.jsLoader=function(a,c){if(g.isString(a)&&a!==""){c=c||{};o.generateId(c);e.kill(c.id);i[c.id].chunks=[{src:a,content:"",type:j.JSNODE,params:{href:a}}];c.underground=true;t(c);m(c.id,c);return c.id}return null};
e.cssLoader=function(a,c){if(g.isString(a)&&a!==""){c=c||{};o.generateId(c);e.kill(c.id);i[c.id].chunks=[{src:a,content:"",type:j.CSSNODE,params:{href:a}}];c.underground=true;t(c);m(c.id,c);return c.id}return null};e.isAlive=function(a){return a&&g.isObject(i[a])&&i[a].chunks.length>0};e.kill=function(a){if(a&&!g.isObject(i[a]))i[a]={chunks:[],destroyer:null};else if(this.isAlive(a))i[a].chunks=[]};e.destroy=function(a){this.kill(a);a&&!g.isObject(i[a])&&i[a].destroyer.fire(v(a),{})};e.onDestroy=
function(a,c,b){if(g.isObject(i[a])&&g.isObject(i[a].destroyer)){g.isObject(b)?i[a].destroyer.subscribe(c,b,true):i[a].destroyer.subscribe(c);return true}return false};e.init=function(a){a=a||{};a.relative=a.relative||false;q=a};e.firewall=function(a,c,b){for(var d=null;a.indexOf("&amp;")>-1;)a=a.replace("&amp;","&");c.proxy=c.proxy||j.proxy;if(g.isFunction(c.firewall))a=c.firewall.apply(c,[a]);else if(!c.monolithic&&!b&&c.proxy)if((d=a.match(z))&&d[2]!==document.domain)a=c.proxy+escape(a);return a};
e.obj2query=function(a){var c="";if(g.isObject(a))for(key in a)if(a.hasOwnProperty(key)){c+=c==""?"":"&";c+=key+"="+a[key]}return c};e.augmentURI=function(a,c){c=c||{};a=K(a,this.strictMode);var b="";a.queryKey=a.queryKey||{};g.augmentObject(a.queryKey,c,true);if(a.protocol)b+=a.protocol+":";if(this.strictMode){if(/^(?:[^:\/?#]+:)?\/\//.test(a.source))b+="//"}else if(/^(?:(?![^:@]+:[^:@\/]*@)[^:\/?#.]+:)?\/\//.test(a.source))b+="//";if(a.authority){if(a.userInfo){if(a.user)b+=a.user;if(a.userInfo.indexOf(":")>
-1)b+=":";if(a.password)b+=a.password;b+="@"}if(a.host)b+=a.host;if(a.port)b+=":"+a.port}if(a.relative){if(a.path){if(a.directory)b+=a.directory;if(a.file)b+=a.file}b+="?";for(sName in a.queryKey)if(a.queryKey.hasOwnProperty(sName))b+=sName+"="+a.queryKey[sName]+"&";if(a.anchor)b+="#"+a.anchor}return b};e.toString=function(){return"YUI Dispatcher Plugin"};return e}()})();YAHOO.util.Dispatcher=YAHOO.plugin.Dispatcher;YAHOO.register("dispatcher",YAHOO.plugin.Dispatcher,{version:"2.1",build:"237"});
